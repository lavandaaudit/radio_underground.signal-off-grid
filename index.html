<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>ibonarium.stability.human.lab.live</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

<style>
*{margin:0;padding:0;box-sizing:border-box}

html,body{
  width:100%;
  height:100%;
  background:#000;
  color:#cfefff;
  font-family:Inter,system-ui,monospace;
}

.wrapper{
  width:100%;
  height:100%;
  display:flex;
  justify-content:center;
  align-items:center;
}

.panel{
  width:96%;
  height:92%;
  display:flex;
  gap:24px;
}

.left{
  width:40%;
  height:100%;
  border:1px solid #0ff3;
  padding:20px;
  overflow-y:auto;
}

.left h2{
  text-align:center;
  font-size:22px;
  margin-bottom:18px;
  color:#7fffd4;
}

.indicator{
  margin-bottom:14px;
  font-size:16px;
  line-height:1.5;
}

.indicator span{color:#9affff}

.right{
  width:60%;
  height:100%;
  border:1px solid #0ff3;
  padding:20px;
  display:flex;
}

canvas{
  width:100%!important;
  height:100%!important;
}
</style>
</head>

<body>
<div class="wrapper">
<div class="panel">

<!-- LEFT -->
<div class="left">
<h2>КОСМІЧНІ ТА ГЕОМАГНІТНІ ПОКАЗНИКИ</h2>

<div class="indicator">Solar Wind Speed (km/s): <span id="sw_speed">—</span></div>
<div class="indicator">Solar Wind Density (/cc): <span id="sw_density">—</span></div>
<div class="indicator">Solar Wind Temperature (K): <span id="sw_temp">—</span></div>

<div class="indicator">IMF Bt – Total Magnetic Field (nT): <span id="imf_bt">—</span></div>
<div class="indicator">IMF Bz (nT): <span id="imf_bz">—</span></div>
<div class="indicator">IMF By (nT): <span id="imf_by">—</span></div>

<div class="indicator">Solar Wind Dynamic Pressure (nPa): <span id="pressure">—</span></div>

<div class="indicator">Proton Flux &gt;10 MeV: <span id="proton_flux">SWPC GOES</span></div>
<div class="indicator">Electron Flux &gt;2 MeV: <span id="electron_flux">SWPC GOES</span></div>

<div class="indicator">Kp Index: <span id="kp">—</span></div>
<div class="indicator">Dst Index (nT): <span id="dst">NOAA Dst realtime</span></div>
<div class="indicator">AE Index (Auroral Electrojet): <span id="ae">Auroral activity</span></div>

<div class="indicator">Geomagnetic Storm Level (G1–G5): <span id="storm">—</span></div>
</div>

<!-- RIGHT -->
<div class="right">
<canvas id="pulseChart"></canvas>
</div>

</div>
</div>

<script>
const labels=[];
const pulseData=[];

const ctx=document.getElementById("pulseChart").getContext("2d");

const pulseChart=new Chart(ctx,{
  type:"line",
  data:{
    labels:labels,
    datasets:[{
      label:"PULSE INDEX – SYSTEM BREATH",
      data:pulseData,
      borderWidth:3,
      tension:0.45
    }]
  },
  options:{
    responsive:true,
    maintainAspectRatio:false,
    scales:{
      x:{ticks:{color:"#9ff"},grid:{color:"#022"}},
      y:{ticks:{color:"#9ff"},grid:{color:"#022"}}
    },
    plugins:{
      legend:{labels:{color:"#cff"}}
    }
  }
});

async function updateData(){
try{
  const plasma=await fetch("https://services.swpc.noaa.gov/products/solar-wind/plasma-1-day.json").then(r=>r.json());
  const mag=await fetch("https://services.swpc.noaa.gov/products/solar-wind/mag-1-day.json").then(r=>r.json());
  const kp=await fetch("https://services.swpc.noaa.gov/products/noaa-planetary-k-index.json").then(r=>r.json());

  const p=plasma.at(-1);
  const m=mag.at(-1);
  const k=kp.at(-1);

  const Bt=parseFloat(m[6]);
  const Bz=Math.abs(parseFloat(m[5]));
  const Pressure=parseFloat(p[7]);
  const Kp=parseFloat(k[1]);

  const pulse =
    (Bt * 0.35) +
    (Bz * 0.25) +
    (Pressure * 0.25) +
    (Kp * 0.15);

  const time=new Date().toLocaleTimeString();
  labels.push(time);
  pulseData.push(pulse);

  if(labels.length>30){
    labels.shift();
    pulseData.shift();
  }

  document.getElementById("sw_speed").textContent=p[2];
  document.getElementById("sw_density").textContent=p[1];
  document.getElementById("sw_temp").textContent=p[3];

  document.getElementById("imf_bt").textContent=Bt;
  document.getElementById("imf_bz").textContent=m[5];
  document.getElementById("imf_by").textContent=m[4];
  document.getElementById("pressure").textContent=Pressure;
  document.getElementById("kp").textContent=Kp;

  document.getElementById("storm").textContent=
    Kp>=8?"G4–G5":
    Kp>=7?"G3":
    Kp>=6?"G2":
    Kp>=5?"G1":"Quiet";

  pulseChart.update();

}catch(e){console.error("DATA ERROR",e);}
}

updateData();
setInterval(updateData,60000);
</script>
</body>
</html>
